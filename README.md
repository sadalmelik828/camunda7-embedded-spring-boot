# Camunda Spring Boot

Servicio que usa el framework Spring Boot y contiene Camunda 7.22.0 embebido externalizando las configuraciones. Este servicio tiene la capacidad de enviar metricas, trazas y logs a un colector de Open Telemetry para observabiidad.

## Parámetros de Configuración

| **Parámetro**                                                                | **Variable de Ambiente**          | **Tipo** | **Valor por Defecto**                       | **Descripción**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|------------------------------------------------------------------------------|-----------------------------------|----------|---------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| server.tomcat.max-connections                                                | TOMCAT_MAX_CONNECTIONS            | Int      | 8192                                        | Indica la máxima cantida de conexiones que permitirá el servidor web.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| server.tomcat.threads.max                                                    | TOMCAT_MAX_THREADS                | Int      | 200                                         | Indica la máxima cantidad de hilos que abre el servidor web.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| camunda.bpmn.job-executor-acquire-by-priority                                | JOB_EXEC_BY_PRIORITY              | Boolean  | true                                        | Indica si el ejecutor de trabajos adquiere los trabajos por prioridades.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| camunda.bpmn.database.schema-update                                          | SCHEMA_UPDATE                     | Boolean  | true                                        | Indica si en cada inicio del servicio se verifica y ejecuta DDL en la base de datos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| camunda.bpmn.admin-user.id                                                   | ADMIN_USER                        | String   | demo                                        | Indica el identificador del usuario administrador por defecto.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| camunda.bpmn.admin-user.password                                             | ADMIN_PASSWD                      | String   | demo                                        | Contiene la contraseña del usuario administrador por defecto.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| camunda.bpmn.job-execution.max-jobs-per-acquisition                          | JE_MAX_JOB_PER_ACQ                | Int      | 4                                           | Indica la máxima cantidad de trabajos que toma al tiempo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| camunda.bpmn.job-execution.queue-capacity                                    | JE_QUEUE_CAP                      | Int      | 4                                           | Indica la cantidad de trabajos que se tendrán en la cola para procesar.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| camunda.bpmn.job-execution.core-pool-size                                    | JE_CORE_POOL_SIZE                 | Int      | 4                                           | Indica la cantidad inicial de trabajos que se tendrán en el grupo de trabajos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| camunda.bpmn.job-execution.max-pool-size                                     | JE_MAX_POOL_SIZE                  | Int      | 12                                          | Indica la cantidad máxima de trabajos que se tendrán en el grupo de trabajos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| camunda.bpmn.job-execution.keep-alive-seconds                                | JE_KEEP_ALIVE                     | Int      | 0                                           | Especifica el tiempo en segunds que los subprocesos se mantendrán activos cuando no haya tareas presentes antes de que los subprocesos finalicen hasta que se alcance el tamaño del grupo central.                                                                                                                                                                                                                                                                                                                                                                      |
| camunda.bpmn.job-execution.lock-time-in-millis                               | JE_LOCK_TIME                      | Long     | 300000                                      | Especifica el tiempo en milisegundos que un trabajo adquirido está bloqueado para su ejecución. Durante ese tiempo, ningún otro ejecutor de trabajos puede adquirir el trabajo.                                                                                                                                                                                                                                                                                                                                                                                         |
| camunda.bpmn.job-execution.wait-time-in-millis                               | JE_WAIT_TIME                      | Long     | 5000                                        | Especifica el tiempo de espera del subproceso de adquisición de trabajos en milisegundos en caso de que haya menos trabajos disponibles para su ejecución que los solicitados durante la adquisición. <br>Si esto sucede repetidamente, el tiempo de espera aumenta exponencialmente por el factor waitIncreaseFactor. <br>El tiempo de espera está limitado por maxWait.                                                                                                                                                                                               |
| camunda.bpmn.job-execution.max-wait                                          | JE_MAX_WAIT                       | Long     | 60000                                       | Especifica el tiempo máximo de espera del hilo de adquisición de trabajo en milisegundos en caso de que haya menos trabajos disponibles para ejecución que los solicitados durante la adquisición.                                                                                                                                                                                                                                                                                                                                                                      |
| camunda.bpmn.job-execution.backoff-time-in-millis                            | JE_BACKOFF_TIME                   | Long     | 0                                           | Especifica el tiempo de espera del subproceso de adquisición de trabajos en milisegundos en caso de que se adquirieran trabajos pero no se pudieran bloquear. <br>Esta condición indica que hay otros subprocesos de adquisición de trabajos que adquieren trabajos en paralelo. <br>Si esto sucede repetidamente, el tiempo de espera se incrementa exponencialmente por el factor waitIncreaseFactor. <br>El tiempo está limitado por maxBackoff. Con cada aumento en el tiempo de espera, la cantidad de trabajos adquiridos también aumenta por waitIncreaseFactor. |
| camunda.bpmn.job-execution.max-backoff                                       | JE_MAX_BACKOFF                    | Long     | 0                                           | Especifica el tiempo de espera máximo del hilo de adquisición de trabajos en milisegundos en caso de que se adquirieran trabajos pero no se pudieran bloquear.                                                                                                                                                                                                                                                                                                                                                                                                          |
| camunda.bpmn.job-execution.backoff-decrease-threshold                        | JE_BACKOFF_DECREASE_THRESHOLD     | Int      | 100                                         | Especifica la cantidad de ciclos de adquisición de trabajos exitosos sin un error de bloqueo de trabajo antes de que el tiempo de interrupción se reduzca nuevamente. <br>En ese caso, el tiempo de interrupción se reduce mediante waitIncreaseFactor.                                                                                                                                                                                                                                                                                                                 |
| camunda.bpmn.job-execution.wait-increase-factor                              | JE_WAIT_INCREASE_FACTOR           | Float    | 2.0                                         | Especifica el factor por el cual se incrementan los tiempos de espera y de retroceso en caso de que sus condiciones de activación se cumplan repetidamente.                                                                                                                                                                                                                                                                                                                                                                                                             |
| camunda.bpmn.job-execution.deployment-aware                                  | JE_DEPLOYMENT_AWARE               | Boolean  | false                                       | Controla si el ejecutor del trabajo es consciente de la implementación o no.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| camunda.bpmn.authorization.enabled                                           | ENABLE_AUTH                       | Boolean  | false                                       | Activa comprobaciones de autorización. Se usa especialmente para permiso a través del API de Java.                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| camunda.bpmn.generic-properties.properties.history                           | CFG_HISTORY_LEVEL                 | String   | full                                        | Establece el nivel del historial del motor de proceso. Los valores posibles son: full, audit, activity y none.                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| camunda.bpmn.generic-properties.properties.historyCleanupDegreeOfParallelism | CFG_HISTORY_PARALLELISM           | Int      | 3                                           | Define el nivel de paralelismo para la limpieza del historial. El valor predeterminado es 1 (sin paralelismo). El valor máximo permitido es 8.                                                                                                                                                                                                                                                                                                                                                                                                                          |
| camunda.bpmn.generic-properties.properties.historyCleanupBatchSize           | CFG_HISTORY_BATCH_SIZE            | Int      | 100                                         | Define la cantidad de objetos de nivel superior (por ejemplo, instancias de procesos históricos) que se eliminarán a la vez. El valor predeterminado y máximo es 500.                                                                                                                                                                                                                                                                                                                                                                                                   |
| camunda.bpmn.generic-properties.properties.historyCleanupStrategy            | CFG_HISTORY_CLEANUP_STRATEGY      | String   | removalTimeBased                            | Controla qué estrategia de limpieza del historial se utiliza. Los posibles valores son removalTimeBased y endTimeBased.                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| camunda.bpmn.generic-properties.properties.historyRemovalTimeStrategy        | CFG_HISTORY_REMOVAL_TIME_STRATEGY | String   | end                                         | Controla si se establece el tiempo de eliminación de una instancia histórica y cuándo. Los posibles valores son end, start y none.                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| camunda.bpmn.generic-properties.properties.historyCleanupJobLogTimeToLive    | CFG_HISTORY_CLEANUP_JOB_TTL       | String   | P5D                                         | Define el tiempo de vida del historial para las entradas del registro de trabajos de historial generadas por los trabajos de limpieza del historial. <br>Esto funciona con la estrategia de limpieza del historial removalTimeBased. <br>El tiempo de vida del historial define la cantidad de días utilizando una hora especificada por el formato de fecha ISO-8601. <br>La función solo acepta la notación para definir una cantidad de días.                                                                                                                        |
| camunda.bpmn.generic-properties.properties.taskMetricsTimeToLive             | CFG_TASK_METRICS_TTL              | String   | P30D                                        | Define el tiempo de vida de las entradas de métricas de tareas generadas por las asignaciones de tareas del usuario. <br>El tiempo de vida del historial define la cantidad de días utilizando una hora especificada por el formato de fecha ISO-8601. <br>La función solo acepta la notación para definir una cantidad de días.                                                                                                                                                                                                                                        |
| camunda.bpmn.generic-properties.properties.failedJobRetryTimeCycle           | CFG_JOB_RETRY_TIME_CYCLE          | String   | R5/PT5M                                     | Establece la frecuencia con la que se vuelve a intentar un trabajo después de una falla y cuánto tiempo debe esperar el motor hasta que intente ejecutar un trabajo nuevamente.                                                                                                                                                                                                                                                                                                                                                                                         |
| management.tracing.sampling.probability                                      | TRACING_SAMPLING                  | Float    | 1                                           | Probabilidad en el rango de 0,0 a 1,0 de que se muestre un rastro.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| management.tracing.enabled                                                   | ENABLED_TRACING                   | Boolean  | false                                       | Si la configuración automática del seguimiento está habilitada para exportar y propagar seguimientos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| management.otlp.metrics.export.url                                           | OTLP_METRICS_URL                  | String   | http://localhost:4318/v1/metrics            | URI del servidor OLTP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| management.otlp.metrics.export.enabled                                       | ENABLED_EXPORT_METRICS            | Boolean  | false                                       | Si está habilitada la exportación de métricas a este backend.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| management.otlp.tracing.endpoint                                             | OTLP_TRACING_URL                  | String   | http://localhost:4318/v1/traces             | URL del HTTP API del colector OTel.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| log.exporter.enabled                                                         | ENABLED_EXPORTER_LOG              | Boolean  | false                                       | Indica si se exportan o no los logs al sistema de recolección de OpenTelemetry.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| log.exporter.url                                                             | URL_EXPORTER_LOG                  | String   | http://localhost:4317                       | URL del gRPC del colector OTel.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| persistence.postgresql.driverClassName                                       | DB_DRIVER                         | String   | org.postgresql.Driver                       | Nombre de la clase del driver a utilizar para interactuar con la base de datos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| persistence.postgresql.jdbcUrl                                               | DB_URL                            | String   | jdbc:postgresql://localhost:5432/camunda722 | URI de conexión a la base de datos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| persistence.postgresql.username                                              | DB_USER                           | String   | camunda_user                                | Establezca el nombre de usuario predeterminado utilizado para las llamadas DataSource.getConnection(username, password).                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| persistence.postgresql.password                                              | DB_PASSWORD                       | String   | >K8Mqs<BArq2QOfP]5E                         | Establezca la contraseña predeterminada que se utilizará para las llamadas DataSource. getConnection(username, password)                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| persistence.postgresql.hikari.poolName                                       | HIKARI_POOL_NAME                  | String   | camundaPool                                 | Establezca el nombre del grupo de conexiones. Esto se utiliza principalmente en las consolas de registro y administración de JMX para identificar grupos y configuraciones de grupos.                                                                                                                                                                                                                                                                                                                                                                                   |
| persistence.postgresql.hikari.keepAliveTime                                  | HIKARI_KEEP_ALIVE_TIME            | Long     | 60000                                       | Esta propiedad controla el intervalo de mantenimiento de la conexión en el grupo. El subproceso de mantenimiento de la conexión nunca probará una conexión en uso, solo se probará cuando esté inactiva.                                                                                                                                                                                                                                                                                                                                                                |
| persistence.postgresql.hikari.maxLifeTime                                    | HIKARI_MAX_LIFE_TIME              | Long     | 300000                                      | Esta propiedad controla la duración máxima de una conexión en el grupo. Cuando una conexión alcanza este tiempo de espera, incluso si se ha utilizado recientemente, se retirará del grupo. <br>Una conexión en uso nunca se retirará, solo se eliminará cuando esté inactiva.                                                                                                                                                                                                                                                                                          |
| persistence.postgresql.hikari.connectionTimeout                              | HIKARI_CONN_TIME_OUT              | Long     | 30000                                       | Establezca la cantidad máxima de milisegundos que un cliente esperará una conexión del grupo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| persistence.postgresql.hikari.idleTimeout                                    | HIKARI_IDLE_TIME_OUT              | Long     | 600000                                      | Esta propiedad controla la cantidad máxima de tiempo (en milisegundos) que una conexión puede permanecer inactiva en el grupo. <br>El hecho de que una conexión se retire como inactiva o no está sujeto a una variación máxima de +30 segundos y una variación promedio de +15 segundos. <br>Una conexión nunca se retirará como inactiva antes de este tiempo de espera. Un valor de 0 significa que las conexiones inactivas nunca se eliminan del grupo.                                                                                                            |
| persistence.postgresql.hikari.minimumIdle                                    | HIKARI_MIN_IDLE                   | Int      | 10                                          | La propiedad controla la cantidad mínima de conexiones inactivas que HikariCP intenta mantener en el grupo, incluidas las conexiones inactivas y las que están en uso. <br>Si las conexiones inactivas caen por debajo de este valor, HikariCP hará todo lo posible para restaurarlas de manera rápida y eficiente.                                                                                                                                                                                                                                                     |
| persistence.postgresql.hikari.maximumPoolSize                                | HIKARI_MAX_POOL_SIZE              | Int      | 10                                          | La propiedad controla el tamaño máximo que puede alcanzar el grupo, incluidas las conexiones inactivas y en uso. <br>Básicamente, este valor determinará la cantidad máxima de conexiones reales al backend de la base de datos.                                                                                                                                                                                                                                                                                                                                        |
| management.metrics.tags.k8sPodName                                           | MS_POD_NAME                       | String   | default_camunda_pod                         | Nombre que tendrá la instancia del microservico en un ambiente de Kubernetes. Este parámetro podrá ser configurado con las variables de Kubernetes en el archivo configMap.                                                                                                                                                                                                                                                                                                                                                                                             |